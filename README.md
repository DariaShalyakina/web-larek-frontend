# Проектная работа "Веб-ларек"

# Описание проекта 
Проект представляет собой набор компонентов и интерфейсов для работы с интернет-магазином. В проекте реализованы компоненты для отображения каталога товаров, корзины, модального окна, страницы заказа и других элементов интерфейса.

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/styles/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды
```
npm install
npm run start
```
или
```
yarn
yarn start
```
## Сборка
```
npm run build
```
или
```
yarn build
```
## Описание

## Page

**Описание:**
Компонент Page отвечает за отрисовку общей структуры страницы и обработку глобальных событий.

**Интерфейс:**
```
interface IPage {
   counter: number; // Счетчик товаров в корзине
   catalog: HTMLElement[]; // Список элементов каталога
   locked: boolean; // Флаг блокировки страницы
}
```

**Свойства:**
+ counter: Количество товаров в корзине.
+ catalog: Массив элементов каталога.
+ locked: Флаг, указывающий, заблокирована ли страница.

**Методы:**
- constructor(container: HTMLElement, events: IEvents): Конструктор компонента.
- set counter(value: number): Устанавливает значение счетчика товаров в корзине.
- set catalog(items: HTMLElement[]): Устанавливает массив элементов каталога.
- set locked(value: boolean): Устанавливает флаг блокировки страницы.

**Обработчики событий:**
- Компонент обрабатывает событие клика по элементу с классом `header__basket` и вызывает событие `bids:open` в объекте событий events.


## ProductCard

**Описание:**
Компонент ProductCard отвечает за отрисовку карточки товара.

**Интерфейс:**
```
interface IProduct {
  id: string;
  title: string;
  description?: string;
  image?: string;
  category: string;
  price: number | null;
}
```
```
interface IProductCardActions {
  onClick: (event: MouseEvent) => void;
}
```

**Свойства:**
+ id: Уникальный идентификатор товара.
+ title: Название товара.
+ description: Описание товара (необязательно).
+ image: Ссылка на изображение товара (необязательно).
+ category: Категория товара.
+ price: Цена товара (может быть null).

**Методы:**
- constructor(container: HTMLElement, actions?: IProductCardActions): Конструктор компонента.
- set id(value: string): Устанавливает идентификатор товара.
- get id(): string: Возвращает идентификатор товара.
- set title(value: string): Устанавливает название товара.
- get title(): string: Возвращает название товара.
- set image(value: string): Устанавливает ссылку на изображение товара.
- set price(value: number | null): Устанавливает цену товара.
- set category(value: string): Устанавливает категорию товара.

**Обработчики событий:**
Если в конструктор передается объект с колбэк-функцией onClick, она добавляется как обработчик события клика по кнопке добавления товара в корзину или по самой карточке товара, если кнопки нет.

## Order
**Описание:**
Компонент **Order** отвечает за отображение и обработку формы заказа.

**Интерфейс:**
```
interface IOrderForm {
	payment: 'online' | 'cash' | null;
    address: string;
	email: string;
	phone: string;
}
```
**Свойства:**
+ payment: Способ оплаты ('online', 'cash' или null).
+ address: Адрес доставки.
+ email: Адрес электронной почты заказчика.
+ phone: Номер телефона заказчика.

**Методы:**
- constructor(container: HTMLFormElement, events: IEvents): Конструктор компонента, который принимает контейнер формы и объект событий.
- bindEvents(): Привязывает обработчики событий к элементам формы.
- updatePaymentButtons(): Обновляет стили кнопок оплаты.
- handleNextButtonClick(): Обрабатывает нажатие на кнопку "Далее".
- get payment(): Геттер для свойства payment.
- set payment(value: string): Сеттер для свойства payment.
- get address(): Геттер для свойства address.
- set address(value: string): Сеттер для свойства address.

**Обработчики событий:**
**Компонент обрабатывает следующие события:**
- Клик по кнопкам оплаты
- Клик по кнопке "Далее"

## Basket
**Описание:**
Компонент Basket отвечает за отображение содержимого корзины и обработку событий, связанных с ней.

**Интерфейс:**
```
interface IBasketView {
    items: HTMLElement[];
    total: number;
    selected: string[];
}
```
**Свойства:**
+ items: Массив элементов, представляющих товары в корзине.
+ total: Общая сумма заказа.
**Методы:**
- constructor(container: HTMLElement, events: EventEmitter): Конструктор компонента, который принимает контейнер и объект событий.
- set items(items: HTMLElement[]): Устанавливает массив элементов товаров в корзине.
**Обработчики событий:**
Компонент обрабатывает событие клика по кнопке оформления заказа и вызывает событие `order:open` в объекте событий events.

## Modal
**Описание:**
Компонент Modal отвечает за отображение модальных окон.

**Интерфейс:**
```
interface IModalData {
	content: HTMLElement;
	product?: IProduct;
}
```

**Свойства:**
+ content: Содержимое модального окна.
+ product: Объект товара, связанный с модальным окном (необязательно).

**Методы:**
- constructor(container: HTMLElement | string): Конструктор компонента, который принимает контейнер или его селектор.
- init(): Инициализирует компонент, добавляя обработчики событий.
- open(data?: IModalData): Открывает модальное окно и отрисовывает переданное содержимое.
- close(): Закрывает модальное окно и удаляет его содержимое.
- render(data: IModalData): HTMLElement: Отрисовывает переданное содержимое в модальное окно и возвращает контейнер модального окна.

**Обработчики событий:**
Компонент обрабатывает следующие события:
- Клик по кнопке закрытия модального окна
- Клик по фону модального окна (кроме содержимого)

## Form
**Описание:**
Компонент Form представляет собой основу для создания различных форм в приложении.

**Интерфейс:**
```
interface IForm {
	valid: boolean; // Валидность формы.
	errors: string[]; // Ошибки при заполнении формы.
}
```

**Свойства:**
+ valid: Флаг, указывающий, валидна ли форма.
+ errors: Массив строк, содержащих сообщения об ошибках в форме.
  
**Методы:**
- constructor(container: HTMLFormElement, events: IEvents):Конструктор компонента, который принимает контейнер формы и объект событий.
- onInputChange(field: keyof T, value: string): Обработчик события изменения полей формы.
- set valid(value: boolean): Устанавливает значение свойства valid.
- set errors(value: string[]): Устанавливает значение свойства errors.
- render(state: Partial<T> & IForm): HTMLFormElement: Отрисовывает форму.

**Обработчики событий:**
Компонент обрабатывает следующие события:
- input: Вызывается при изменении значения поля формы.
- submit: Вызывается при отправке формы.

## Contacts 
Расширяет класс **Form** и предоставляет дополнительную функциональность для работы с формой контактов:

+ Сеттер phone: устанавливает значение поля ввода с именем "phone" в контейнере формы.
+ Сеттер email: устанавливает значение поля ввода с именем "email" в контейнере формы.

## Success
**Описание:**
Компонент Success отвечает за отображение сообщения об успешном действии, например, об оформлении заказа или списании синапсов.

**Интерфейс:**
```
export interface ISuccess {
    description: number;
}
```

**Свойства:**
+ description: Описание успешного действия, например, количество списанных синапсов.

**Методы:**
- constructor(container: HTMLElement, actions?: ISuccessActions): Конструктор компонента, который принимает контейнер и объект с колбэк-функциями.
- set description(value: number): Устанавливает описание успешного действия.

**Обработчики событий:**
Компонент обрабатывает событие клика по кнопке закрытия сообщения, если она есть.

## AppState
Класс AppState представляет собой модель состояния приложения. 
Он управляет списком товаров в корзине (basket) и каталогом всех товаров (catalog), а также данными о заказе клиента (orderDetails).

**Свойства класса AppState:**
+ basket: Массив объектов Product, представляющих товары в корзине.
+ catalog: Массив объектов Product, представляющих все товары в магазине.

**Методы класса AppState:**
- setProductList(items: IProduct[]): Устанавливает список товаров в каталоге.
- orderDetails: Объект, содержащий данные о заказе клиента, включая список товаров, способ оплаты, общую стоимость, адрес, электронную почту и номер телефона.
- order: Объект, содержащий данные о форме заказа (не отображен в приведенном фрагменте).
- formErrors: объект с ошибками, возникшими при заполнении форм.

**Методы работы с корзиной:**
- addProductToBasket(value: Product): Добавляет товар в корзину.
- removeProductFromBasket(id: string): Удаляет товар из корзины по его идентификатору.
- getBasketCount(): Возвращает количество товаров в корзине.
- setOrderedItems(): Устанавливает список товаров, заказанных клиентом.
- getBasketTotal(): Возвращает общую стоимость товаров в корзине.
Работа с полями формы заказа:
- setOrderField(field: keyof IOrderForm, value: string): Устанавливает значение указанного поля в объекте order.
- validateOrder(): валидирует данные заказа и возвращает true, если ошибок нет, и false, если ошибки присутствуют.

## AppAPI
**Интерфейс IAppAPI:**
Интерфейс IAppAPI определяет методы для взаимодействия с API приложения:
+ getProductList: Получает список продуктов.
+ postOrderProduct: Создает заказ на продукт.

**Конструктор**
Конструктор AppAPI принимает следующие параметры:
+ cdn: URL-адрес CDN для загрузки изображений продуктов.
+ baseUrl: Базовый URL-адрес API.
+ options: Дополнительные опции для запросов (по умолчанию пустой объект).

**Методы**
- getProductList: Возвращает список продуктов из API. Полученные изображения продукта преобразуются с использованием URL-адреса CDN.
- postOrderProduct: Отправляет заказ на продукт на сервер и возвращает результат.

**Model**

Model - это абстрактный базовый класс, который служит для отделения моделей от обычных объектов данных. Он предоставляет следующие возможности:

**Конструктор: **
Конструктор принимает частичные данные модели и экземпляр IEvents, который используется для обработки событий.
Метод emitChanges: Этот метод позволяет модели генерировать события. Ему можно передать имя события и необязательный полезный груз.
Используя класс Model, вы можете создавать свои собственные модели, которые могут вызывать события и реагировать на изменения в своих данных. Это полезно для создания интерактивных пользовательских интерфейсов и поддержания синхронизации состояния между различными частями приложения.

## IEvents
**Описание**
IEvents - это интерфейс, определяющий простой брокер событий. 

**Методы:**
+ on: Подписывается на событие с помощью обратного вызова.
+ emit: Инициирует событие с необязательными данными.
+ trigger: Возвращает функцию, которая при вызове генерирует событие.


## EventEmitter
EventEmitter - это реализация IEvents, которая использует внутреннюю карту для хранения подписчиков для каждого события. Он предоставляет следующие дополнительные **методы**:
+ off: Отписывается от события с помощью обратного вызова.
+ onAll: Подписывается на все события с помощью обратного вызова.
+ offAll: Отписывается от всех событий.

**Использование**
Вы можете использовать EventEmitter для создания собственных систем обработки событий в своем приложении. Например, вы можете использовать для создания интерактивного пользовательского интерфейса или для координации между различными частями вашего приложения.

## Component
**Описание**
Component - это абстрактный базовый класс для всех компонентов в вашем приложении. Он предоставляет следующие возможности:
**Конструктор:**
Конструктор принимает корневой элемент компонента HTML и должен вызываться всеми дочерними классами.

**Методы работы с DOM:** 
Component предоставляет несколько методов для упрощения взаимодействия с DOM, таких как `toggleClass`, `setText` и `setDisabled`.

**Метод render:**
Этот метод должен переопределяться дочерними классами и возвращать корневой элемент DOM компонента.

**Использование**
Чтобы создать свой собственный компонент, вы должны создать класс, который наследуется от Component и переопределяет метод render. 

## Api
**Типы данных**

**ApiResponseList<Type>**: Тип, представляющий ответ API со списком элементов. 

Он содержит следующие **свойства**:
+ total: Общее количество элементов.
+ items: Массив элементов.

**ApiPostMethods**: Тип, представляющий методы HTTP POST запросов, поддерживаемые этим API:
+ 'POST'
+ 'PUT'
+ 'DELETE'

**Конструктор**
Конструктор Api принимает следующие параметры:
- baseUrl: Базовый URL-адрес API.
- options: Дополнительные параметры запроса (по умолчанию пустой объект).

**Методы**
- handleResponse: Обрабатывает ответ сервера и извлекает данные JSON. Если ответ не является успешным (код статуса не равен 200), он возвращает отклоненный промис с сообщением об ошибке.
- get: Выполняет HTTP GET запрос и возвращает промис с данными ответа API.
- post: Выполняет HTTP POST, PUT или DELETE запрос и возвращает промис с данными ответа API. Метод запроса по умолчанию - 'POST', но его можно переопределить с помощью параметра method.

**Использование**
Вы можете использовать Api в качестве базового класса для создания собственных API-клиентов.


